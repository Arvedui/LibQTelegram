#ifndef CACHEFETCHER_H
#define CACHEFETCHER_H

#include <QObject>
#include "../autogenerated/types/types.h"
#include "../types/basic.h"
#include "../mtproto/mtprotoreply.h"

class CacheFetcher : public QObject
{
    Q_OBJECT

    public:
        explicit CacheFetcher(QObject *parent = 0);
        void getChannelDifference(Chat* chat, TLInt pts);
        void getFullChat(Chat* chat);

    private:
        void getChannelDifference(InputChannel* inputchannel, TLInt pts);

    private slots:
        void onChannelDifferenceReceived(MTProtoReply* mtreply);
        void onChatFull(MTProtoReply* mtreply);

    signals:
        void usersReceived(const TLVector<User*>& users);
        void chatFullReceived(ChatFull* chatfull);

     private:
        Update* _update;
        QHash<TLLong, InputChannel*> _inputchannels;
};

#endif // CACHEFETCHER_H

