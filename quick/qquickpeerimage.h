#ifndef QQUICKPEERIMAGE_H
#define QQUICKPEERIMAGE_H

#include <QtQuick>
#include <QColor>
#include "../autogenerated/types/types.h"
#include "qquickbaseitem.h"

class QQuickPeerImage : public QQuickBaseItem
{
    Q_OBJECT

    Q_PROPERTY(TelegramObject* peer READ peer WRITE setPeer NOTIFY peerChanged)
    Q_PROPERTY(int size READ size WRITE setSize NOTIFY sizeChanged)

    public:
        QQuickPeerImage(QQuickItem* parent = 0);
        TelegramObject* peer() const;
        int size() const;
        void setPeer(TelegramObject* peer);
        void setSize(int size);

    private:
        TelegramObject* findPeer(TelegramObject* peer);
        void initialize();
        void updateMetrics();
        void updateSource(QVariant sourcevalue);
        void createPeerElement();
        void createFallbackPeerElement();
        QString fallbackText(TelegramObject* telegramobject);
        QString fallbackTitle(const QString& title);

    private slots:
        void reinitialize();
        void bindToElement();

    protected:
        virtual void componentComplete();

    signals:
        void peerChanged();
        void sizeChanged();
        void peerDelegateChanged();
        void fallbackPeerDelegateChanged();

    private:
        TelegramObject* _peer;
        int _size;
};

#endif // QQUICKPEERIMAGE_H
